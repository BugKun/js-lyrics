(function(){var e=function(){try{return this===window}catch(e){return!1}},t=e()?window:global;t.Lyrics=function(e){var t=function(e){var t=function(e){var t=/^\[(\d{1,2}):(\d{1,2})(\.(\d{1,2}))?\]$/g.exec(e);if(!t)return undefined;var n=Number(t[1]),r=Number(t[2]),i=Number(t[4]),s=n*60+r;return i&&(s+=i/100),s},n=e.split("\n"),r=Array(),i=0;for(var s=0;s<n.length;s++){var o=n[s].replace(/(^\s*)|(\s*$)/g,"");if(o.length>0){var u=Array(o),a=Array(),f="";while(u)u=/^(\[\d{1,2}:\d{1,2}(\.\d{1,2})?\])(.*)/g.exec(u[u.length-1]),u&&(a.push(u[1]),f=u[u.length-1]);for(var l=0;l<a.length;l++)r.push({timestamp:t(a[l]),text:f})}}if(!r.length)throw"Failed to parse LRC string.";return r.sort(function(e,t){return e.timestamp>t.timestamp?1:-1}),r},n=t(e),r=0;this.getTimeOffset=function(){return r},this.setTimeOffset=function(e){if(isNaN(e))throw"Invalid offset.";r=Number(e)},this.select=function(e){if(isNaN(e))throw"Invalid timestamp.";var t=Number(e)+r,i=0;if(t<n[0].timestamp)return-1;for(i=0;i<n.length-1;i++)if(n[i].timestamp<=t&&n[i+1].timestamp>t)break;return i},this.toJSON=function(){return n};try{this===window}catch(i){return}var s=undefined,o=undefined;this.bind=function(e){s=e,e.innerHTML="";for(var t=0;t<n.length;t++){var r=document.createElement("p");r.setAttribute("class","lyric"),r.setAttribute("idx",t),n[t].text.length>0?r.innerHTML=n[t].text:r.innerHTML="&nbsp;",e.appendChild(r)}},this.sync=function(e){if(!s)throw"Element for lyrics container is not specified using Lyrics.bind(elem).";var t=this.select(e);if(o!==undefined&&t==o)return!1;o=t;var n=s.querySelector(".lyric[selected]");return n&&n.removeAttribute("selected"),t>=0&&(n=s.querySelector('.lyric[idx="'+t+'"]'),n&&n.setAttribute("selected","selected")),o}}})();